---
title: "Regresión con variables contiuas y categóricas"
author: "Los regresores"
date: "2/11/2019"
output: html_document
---

```{r setup, include=FALSE, echo=FALSE}
library(tidyverse)
library(readr)
library(ggpubr)
```

```{r, echo=FALSE}
datos <- read_table2("http://allman.rhon.itam.mx/~ebarrios/EstApl2-2019/controles/control3/bacterias.dat")
datos$Temp <- as_factor(datos$Temp)
datos$Acid <- as_factor(datos$Acid)
datos$Conc <- as_factor(datos$Conc)
```
En un laboratorio clínico se llevó a cabo un experimento para valorar cómo el nivel de temperatura y la naturaleza ácida de cierto caldo de cultivo influía en el crecimiento de una población de bacterias.

Más específicamente, se consideraron dos factores: temperatura, a tres distintos niveles: 30°C, 60°C y 90°C; dos tipos de caldo de cultivo: básico (B) y ácido (A), cada uno de ellos a dos niveles de concentraciones: baja (L) y alta (H). Como respuesta se consideró como se modificaba una población inicial de 1000 bacterias después de 48 horas de en el ambiente controlado.


```{r}
pl1 <- ggplot(data = datos, aes(x = Temp, y = Nbact)) + 
  geom_boxplot() + 
  geom_point(aes(color = Acid)) + 
  labs(x = "Temperatura", y = "Número de bacterias", color = "Naturaleza ácida") + 
  theme_minimal() + 
  scale_color_discrete(labels = c("básico", "ácido")) + 
  labs(caption = "Figura 1.1 Bacterias por temperatura") +
  theme(plot.caption = element_text(hjust = 0.5)) 

pl2 <- ggplot(data = datos, aes(x = Acid, y = Nbact)) + 
  geom_boxplot() + 
  geom_point(aes(color = Temp)) + 
  labs(x = "Naturaleza ácida", y = "Número de bacterias", color = "Temperatura") + 
  theme_minimal() + 
  scale_color_discrete(labels = c("30°", "60°", "90°")) + 
  labs(caption = "Figura 1.2 Bacterias por acidez") +
  theme(plot.caption = element_text(hjust = 0.5)) 

ggarrange(pl1, pl2) 
```


```{r}
temp.labs <- c("30°C", "60°C", "90°C")
names(temp.labs) <- c("30", "60", "90")

acid.labs <- c("básico", "ácido")
names(acid.labs) <- c("B", "A")

ggplot(data = datos, aes(x = obs, y = Nbact)) + 
  geom_point(aes(color = Conc)) + 
  facet_grid(Acid ~ Temp, labeller = labeller(Acid = acid.labs, Temp = temp.labs)) + 
  theme_bw() +
  labs(x = "Observaciones", y = "Número de bacterias", caption = "Figura 2. Gráfica", color = "Concentración") + 
  theme(plot.caption = element_text(hjust = 0.5)) +
  scale_color_discrete(labels = c("baja", "alta")) 
```



